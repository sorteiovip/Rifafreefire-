<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Rifa Free Fire 10K</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #1a1a2e;
      color: white;
      padding: 15px;
      margin: 0;
    }
    .pagina { display: none; }
    #inicio { display: block; text-align: center; }
    .logo { font-size: 1.8rem; color: #ffcc00; margin: 20px 0; }
    .btn {
      background: #ffcc00;
      color: #1a1a2e;
      padding: 12px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: bold;
      border: none;
      width: 100%;
      margin: 10px 0;
      cursor: pointer;
    }
    .cotas-container {
      max-height: 300px;
      overflow-y: auto;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
      gap: 5px;
    }
    .cota {
      background: #4e2b2a;
      border: 2px solid #ffcc00;
      border-radius: 5px;
      color: white;
      font-size: 12px;
      aspect-ratio: 1;
    }
    .selecionada { background: #ffcc00; color: black; }
    .reservada { background: #ff5555; opacity: 0.5; pointer-events: none; }
    .search-box {
      width: 100%;
      padding: 10px;
      border-radius: 5px;
      margin-bottom: 10px;
    }
    .video-container {
  position: relative;
  padding-bottom: 56.25%;
  height: 0;
  overflow: hidden;
  border-radius: 10px;
  margin: 20px auto;
  max-width: 100%;
  width: 100%;
}
.video-container iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: block;
  margin: 0 auto;
}
    .video-container iframe {
      position: absolute;
      width: 100%;
      height: 100%;
      border: none;
    }
    #pix-code {
      background: white;
      color: black;
      padding: 15px;
      border-radius: 10px;
      text-align: center;
      margin: 20px 0;
    }
    .btn-copiar {
      background: #4e2b2a;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 5px;
      margin-top: 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <!-- IN√çCIO -->
  <div id="inicio" class="pagina">
    <div class="logo">üéØ RIFA FREE FIRE 10K</div>
    <h2>PR√äMIO: CONTA PREMIUM</h2>
    <p>10.000 cotas dispon√≠veis</p>
    <p>R$ 0,50 por cota (at√© 30 por pessoa)</p>
    <button onclick="mostrarPagina('selecao')" class="btn">ESCOLHER COTAS</button>

    <h3 style="margin-top: 30px;">üìπ VIDEO DO PR√äMIO</h3>
    <div class="video-container">
      <iframe src="https://www.youtube.com/embed/jSc3URBakK4" allowfullscreen></iframe>
    </div>
  </div>

  <!-- SELE√á√ÉO -->
  <div id="selecao" class="pagina">
    <button onclick="mostrarPagina('inicio')" style="background: none; border: none; color: #ffcc00;">‚Üê Voltar</button>
    <h2>Selecione at√© 30 cotas:</h2>
    <input type="text" id="busca-cota" class="search-box" placeholder="Buscar cota (ex: 1500)" oninput="filtrarCotas()">
    <div id="cotas-container" class="cotas-container"></div>
    <p>Cotas selecionadas: <span id="contador">0</span>/30</p>
    <p>Total: R$ <span id="total">0.00</span></p>
    <button id="btn-reservar" class="btn" disabled>üì≤ CONFIRMAR COTAS</button>
  </div>

  <!-- PAGAMENTO -->
  <div id="pagamento" class="pagina">
    <button onclick="mostrarPagina('selecao')" style="background: none; border: none; color: #ffcc00;">‚Üê Voltar</button>
    <h2 style="text-align:center;">FINALIZAR PAGAMENTO</h2>
    <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 10px; margin-top: 15px;">
      <h3>üìã RESUMO</h3>
      <p>Nome: <strong id="resumo-nome"></strong></p>
      <p>Cotas: <strong id="resumo-cotas"></strong></p>
      <p>Total: <strong id="resumo-total"></strong></p>
    </div>

    <div id="pix-code">
      <p><strong>Chave PIX:</strong></p>
      <p id="chave-pix">4e2b2a9a-60fb-47a6-a76e-3b1ac466cd71</p>
      <button onclick="copiarChavePix()" class="btn-copiar">üìã Copiar Chave</button>
      <p style="margin-top: 10px;">Valor: <strong id="pix-valor"></strong></p>
    </div>

    <button onclick="enviarWhatsApp()" class="btn" style="background: #25D366;">üì≤ ENVIAR COMPROVANTE</button>
  </div>

  <!-- Firebase v8 -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

  <script>
    // CONFIG
    const firebaseConfig = {
      apiKey: "AIzaSyCITC-27Jyngw7DkRxFW_9sbQJy4uVnuMs",
      authDomain: "rifafreefire-3c9d4.firebaseapp.com",
      databaseURL: "https://rifafreefire-3c9d4-default-rtdb.firebaseio.com",
      projectId: "rifafreefire-3c9d4",
      storageBucket: "rifafreefire-3c9d4.firebasestorage.app",
      messagingSenderId: "504695645299",
      appId: "1:504695645299:web:226f7fe4fe37c57104f606",
      measurementId: "G-77WEQYQK20"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // VARS
    const TOTAL_COTAS = 10000;
    const MAX_SELECAO = 30;
    const VALOR_COTA = 0.50;
    const CHAVE_PIX = "4e2b2a9a-60fb-47a6-a76e-3b1ac466cd71";
    const SEU_WHATSAPP = 5581985315382"";

    let cotasSelecionadas = [];
    let nomeCliente = "";
    let todasCotas = [];

    function mostrarPagina(id) {
      document.querySelectorAll('.pagina').forEach(p => p.style.display = 'none');
      document.getElementById(id).style.display = 'block';

      if (id === 'pagamento') {
        document.getElementById('resumo-nome').textContent = nomeCliente;
        document.getElementById('resumo-cotas').textContent = cotasSelecionadas.join(', ');
        document.getElementById('resumo-total').textContent = `R$ ${(cotasSelecionadas.length * VALOR_COTA).toFixed(2)}`;
        document.getElementById('pix-valor').textContent = `R$ ${(cotasSelecionadas.length * VALOR_COTA).toFixed(2)}`;
      }
    }

    function gerarCotas() {
      const container = document.getElementById('cotas-container');
      container.innerHTML = '';
      todasCotas = [];

      for (let i = 1; i <= TOTAL_COTAS; i++) {
        const btn = document.createElement('button');
        btn.className = 'cota';
        btn.textContent = i;
        btn.dataset.numero = i;
        btn.onclick = () => selecionarCota(i);
        container.appendChild(btn);
        todasCotas.push(btn);
      }

      db.ref("cotas").on("value", snapshot => {
        const ocupadas = snapshot.val() || {};
        todasCotas.forEach(btn => {
          const num = btn.dataset.numero;
          if (ocupadas[num]) {
            btn.classList.add("reservada");
            btn.disabled = true;
          } else {
            btn.classList.remove("reservada");
            btn.disabled = false;
          }
        });
      });
    }

    function selecionarCota(num) {
      const btn = document.querySelector(`.cota[data-numero="${num}"]`);
      if (btn.classList.contains("reservada")) return;

      if (cotasSelecionadas.includes(num)) {
        cotasSelecionadas = cotasSelecionadas.filter(n => n !== num);
        btn.classList.remove("selecionada");
      } else {
        if (cotasSelecionadas.length >= MAX_SELECAO) {
          alert("Voc√™ s√≥ pode selecionar at√© 30 cotas!");
          return;
        }
        cotasSelecionadas.push(num);
        btn.classList.add("selecionada");
      }

      atualizarResumo();
    }

    function atualizarResumo() {
      document.getElementById('contador').textContent = cotasSelecionadas.length;
      document.getElementById('total').textContent = (cotasSelecionadas.length * VALOR_COTA).toFixed(2);
      document.getElementById('btn-reservar').disabled = cotasSelecionadas.length === 0;
    }

    function copiarChavePix() {
      navigator.clipboard.writeText(CHAVE_PIX)
        .then(() => alert("Chave PIX copiada! ‚úÖ"))
        .catch(() => prompt("Copie manualmente:", CHAVE_PIX));
    }

    function enviarWhatsApp() {
      const mensagem = `*RESERVA DE COTAS*%0A%0A‚û§ *Nome:* ${nomeCliente}%0A‚û§ *Cotas:* ${cotasSelecionadas.join(', ')}%0A‚û§ *Total:* R$ ${(cotasSelecionadas.length * VALOR_COTA).toFixed(2)}%0A%0A*Envie o comprovante PIX nesta conversa* üèß`;

      // Salva no Firebase
      cotasSelecionadas.forEach(num => {
        db.ref(`cotas/${num}`).set(true);
      });

      window.open(`https://wa.me/${SEU_WHATSAPP}?text=${mensagem}`, '_blank');

      cotasSelecionadas = [];
      atualizarResumo();
    }

    document.getElementById('btn-reservar').onclick = function () {
      nomeCliente = prompt("Digite seu nome completo:");
      if (nomeCliente) mostrarPagina('pagamento');
    };

    window.onload = gerarCotas;
  </script>

</body>
</html>